<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <style>
    body { font-family: sans-serif; padding: 20px; background: #f4f4f4; }
    .box { background: white; padding: 20px; border-radius: 10px; max-width: 800px; margin: auto; }
    .j-row { border-bottom: 1px solid #eee; padding: 10px 0; }
    .bar { height: 10px; background: #eee; border-radius: 5px; overflow: hidden; margin-top: 5px; }
    .fill { height: 100%; background: #1b5e20; }
  </style>
</head>
<body>
  <div class="box">
    <h2>Monitoring Survey Klasis</h2>
    <div id="prog">Loading data...</div>
    <button onclick="window.location.href='?'" style="margin-top:20px;">Keluar</button>
  </div>
  <script>
    google.script.run.withSuccessHandler(data => {
      let html = "";
      data.forEach(j => {
        const p = (j.jml/10)*100;
        html += `<div class="j-row"><b>${j.nama}</b> (${j.jml}/10)<div class="bar"><div class="fill" style="width:${p}%"></div></div></div>`;
      });
      document.getElementById('prog').innerHTML = html;
    }).getProgresJemaat();
  </script>
</body>
</html>